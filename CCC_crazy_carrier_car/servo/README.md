# 舵机模块  
主要是实现舵机的控制，也是尽量在底层驱动的基础上进行封装，方便上层调用


## 概述
文件夹中的各个.c .h文件都是复制自商家的驱动

***舵机线加长不能用普通杜邦线，一定要用乔兰多线！！！！***
***舵机线加长不能用普通杜邦线，一定要用乔兰多线！！！！***
***舵机线加长不能用普通杜邦线，一定要用乔兰多线！！！！***

***舵机的参数可能会因为重新装车而发生变化，所以在使用前一定要重新测试！！！！***
***舵机的参数可能会因为重新装车而发生变化，所以在使用前一定要重新测试！！！！***
***舵机的参数可能会因为重新装车而发生变化，所以在使用前一定要重新测试！！！！***

## 使用
在main中先`Uart_Init(115200); `然后直接调用`feetech_servo_move`函数，传入对应的参数即可（该函数自带延时）

### 普通舵机参数
**注意：下列参数值可能会因为重新装车而导致变化，如果变化了就得重新测试**
见my_servo.h文件中的定义


### 精密舵机参数
见my_servo.h文件中的定义


## 控制思路
1. 精密舵机
精密舵机对应的position为：0-4095
速度为：0-4095
加速度为：0-256（不确定）

注：目前精密舵机的初始位置仍然是手工测定的

2. 普通舵机
普通舵机的工作频率为50Hz，TIM4的频率为84MHz，预分频系数Prescaler为1680-1，Counter Period的值为4000-1，所以要用`__HAL_TIM_SET_COMPARE(&htim4, TIM_CHANNEL_1, 250);`来控制舵机的角度。高电平时间为
0.5ms~2.5ms对应0°~270°或者0-180，总的周期为20ms，0-270对应的占空比为2.5%~12.5%，对应的计数值为25-125。（注：mg996r是270度，而ds3120是180度）


## 动作设计

### 夹取


## 已完成
- 精密舵机的简单控制
- 普通舵机的简单控制
- 梳理舵机的控制思路，测出初始的位置角度
- 进行舵机的限位控制，尤其是可能会撞到底板的情况

## 未完成
- 给出精密舵机和普通舵机的精准延时时间（既要保证舵机旋转到了给定给定位置，不会提前停下，又要保证不会因为延时时间过长而影响整体的运行速度）
- 如何根据舵机进行解算，如通过机械臂的前后伸缩和中板的左右旋转来实现实时位置的控制（目前的思路是通过视觉的识别给出偏差的结果，然后进行微调，如果距离太远就进行更大步长的调整，相当于没有用PID，直接用分段函数来进行位置的控制，最后给定一个误差量来进行到位的判定。
